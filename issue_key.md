1. Key Server가 방역당국에게 키 전송 (Key Server -> 방역당국)<br/><br/>

    * parameters <br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |MSK_user|User's Manager Secret Key|Int|
        |MSK_owner|Owner's Manager Secret Key|Int|
        |GPK_user|User's Group Public Key|Int|
        |GPK_owner|Owner's Group Public Key|Int|
    <br/>

    * MSK_user<br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |ξ1|Element of Manager Key|Int|
        |ξ2|Element of Manager Key|Int|
    <br/>

    * MSK_owner<br/>
  
        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |ξ1|Element of Manager Key|Int|
        |ξ2|Element of Manager Key|Int|    
    <br/>

    * GPK_user<br/>
  
        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |g1| \<g1> = G1 |Int|
        |g2| \<g2> = G2 |Int|
        |h|h such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |u|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |v|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |w| w = $g2^γ$ |Int|
    <br/>

    * GPK_owner<br/>
  
        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |g1| \<g1> = G1 |Int|
        |g2| \<g2> = G2 |Int|
        |h|h such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |u|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |v|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |w| w = $g2^γ$ |Int
    <br/>
2. 방문자가 token으로 Key Server에게 그룹 개인키 발급 요청 (방문자 -> Key Server)<br/><br/>

    * parameters <br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |token| token(=Nonce) |Int|
    <br/>

    * Response <br/>


      * Success (if (token from Server) == (token from user))

        * parameters
            |params|explanation|type|
            |:------:|:-------------:|:---:|
            |usk|User's Secret Key|Int|  

        * usk
            |params|explanation|type|
            |:------:|:-------------:|:---:|
            |A| element of usk(generated by $g1, x, r$) |Int|
            |x| element of usk(Random Number chosen from Domain Field) |Int|
      * Fail (else)

3. 수집서버가 token으로 그룹 개인키 발급을 요청한 방문자의 신원을 검증하기 위해 Key Server에게 token을 전송 (수집서버 -> Key Server)<br/><br/>

    * parameters <br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |token| token(=Nonce) |Int|
    <br/>

    * Response <br/>


      * Success (if (token from Server) == (token from user))

        * parameters
            |params|explanation|type|
            |:------:|:-------------:|:---:|
            |token| token(=Nonce) |Int| 
            |A| element of usk(Random Number chosen from Domain Field) |Int|  

        
      * Fail (else)

4. 점주가 token으로 Key Server에게 그룹 개인키 발급 요청 (점주 -> Key Server)<br/><br/>

    * parameters <br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |token| token(=Nonce) |Int|
    <br/>

    * Response <br/>


      * Success (if (token from Server) == (token from user))

        * parameters
            |params|explanation|type|
            |:------:|:-------------:|:---:|
            |usk|User's Secret Key|Int|  

        * usk
            |params|explanation|type|
            |:------:|:-------------:|:---:|
            |A| element of usk(generated by $g1, x, r$) |Int|
            |x| element of usk(Random Number chosen from Domain Field) |Int|
      * Fail (else)

5.  수집서버가 token으로 그룹 개인키 발급을 요청한 점주의 신원을 검증하기 위해 Key Server에게 token을 전송 (수집서버 -> Key Server)<br/><br/>

    * parameters <br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |token| token(=Nonce) |Int|
    <br/>

    * Response <br/>


      * Success (if (token from Server) == (token from user))

        * parameters
            |params|explanation|type|
            |:------:|:-------------:|:---:|
            |token| token(=Nonce) |Int| 
            |A| element of usk(Random Number chosen from Domain Field) |Int|  

        
      * Fail (else)

6. Key Server가 수집서버에게 그룹 공개키 전송 (Key Server -> 수집서버)<br/><br/>

    * parameters <br/>

        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |GPK_user|User's Group Public Key|Int|
        |GPK_owner|Owner's Group Public Key|Int|
    <br/>

    * GPK_user<br/>
  
        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |g1| \<g1> = G1 |Int|
        |g2| \<g2> = G2 |Int|
        |h|h such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |u|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |v|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |w| w = $g2^γ$ |Int|
    <br/>

    * GPK_owner<br/>
  
        |params|explanation|type|
        |:------:|:-------------:|:---:|
        |g1| \<g1> = G1 |Int|
        |g2| \<g2> = G2 |Int|
        |h|h such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |u|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |v|u, v such that $u^{ξ1} = v^{ξ2} = h$|Int|
        |w| w = $g2^γ$ |Int
    <br/>